import{d as ee,u as se,a as A,r as i,h as r,b as n,j as e,L as te}from"./index-DKe-Z_P2.js";import{C as P,a as E,b as k,c as T,d as $}from"./carousel-DzpC_nM8.js";import{A as ae,a as N,b as y,c as v}from"./accordion-nDcBrAiS.js";import{A as V,a as z,b as B}from"./avatar-BwSb9T8q.js";import{B as w}from"./badge-DRwcgaHV.js";import{P as le}from"./progress-CLGXQqJn.js";import{B as D}from"./button-DFBl4hJw.js";import{C as R}from"./chevron-right-DyRDFJVn.js";import{T as ie}from"./thumbs-up-fgVDmDDq.js";import"./utils-BBoPzY1E.js";import"./clsx-B-dksMZM.js";import"./arrow-right-C9Hl5Y_I.js";import"./index-BsfGT_ux.js";import"./index-Bwdnf3s5.js";import"./index-BGE1IYPi.js";import"./index-D2E9qB5E.js";import"./chevron-down-BAuY13ro.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],ne=ee("Upload",re),Ue=()=>{const l=se(),{current_user:o,auth_token:h}=A(s=>s.auth),{language:_,timezone:G}=A(s=>s.preferences),[I,L]=i.useState([]),[a,Y]=i.useState(null),[q,M]=i.useState([]),[c,g]=i.useState(null),[x,S]=i.useState(null),[W,p]=i.useState(!0),[d,b]=i.useState({designTitle:"",designDescription:"",fileUrls:[]});i.useEffect(()=>{H(),J()},[]);const H=async()=>{try{p(!0);const s=await r.get("http://localhost:1337/api/design-challenges/active");L(s.data),p(!1)}catch(s){console.error("Error fetching active challenges:",s),l(n({id:Date.now().toString(),type:"error",message:"Failed to load active challenges. Please try again."})),p(!1)}},J=async()=>{try{const s=await r.get("http://localhost:1337/api/design-challenges/past");M(s.data)}catch(s){console.error("Error fetching past challenges:",s),l(n({id:Date.now().toString(),type:"error",message:"Failed to load past challenges. Please try again."}))}},Z=async s=>{try{const t=await r.get(`http://localhost:1337/api/design-challenges/${s}`);Y(t.data),o&&K(s),U(s)}catch(t){console.error("Error fetching challenge details:",t),l(n({id:Date.now().toString(),type:"error",message:"Failed to load challenge details. Please try again."}))}},K=async s=>{try{const t=await r.get(`http://localhost:1337/api/design-challenges/${s}/submission`,{headers:{Authorization:`Bearer ${h}`}});g(t.data)}catch(t){console.error("Error fetching user submission:",t),g(null)}},U=async s=>{try{const t=await r.get(`http://localhost:1337/api/design-challenges/${s}/votes`);S(t.data)}catch(t){console.error("Error fetching voting results:",t),S(null)}},C=s=>{const{name:t,value:m}=s.target;b(f=>({...f,[t]:m}))},O=async s=>{const t=s.target.files;if(t)try{const m=Array.from(t).map(async u=>{const F=new FormData;return F.append("file",u),(await r.post("http://localhost:1337/api/upload",F,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${h}`}})).data.url}),f=await Promise.all(m);b(u=>({...u,fileUrls:[...u.fileUrls,...f]}))}catch(m){console.error("Error uploading files:",m),l(n({id:Date.now().toString(),type:"error",message:"Failed to upload files. Please try again."}))}},Q=async()=>{if(!(!a||!o))try{const s=await r.post(`http://localhost:1337/api/design-challenges/${a.challengeUid}/submit`,d,{headers:{Authorization:`Bearer ${h}`}});g(s.data),l(n({id:Date.now().toString(),type:"success",message:"Your entry has been submitted successfully!"})),b({designTitle:"",designDescription:"",fileUrls:[]})}catch(s){console.error("Error submitting entry:",s),l(n({id:Date.now().toString(),type:"error",message:"Failed to submit your entry. Please try again."}))}},X=async s=>{if(!(!a||!o))try{await r.post(`http://localhost:1337/api/design-challenges/${a.challengeUid}/vote`,{submissionUid:s},{headers:{Authorization:`Bearer ${h}`}}),l(n({id:Date.now().toString(),type:"success",message:"Your vote has been recorded!"})),U(a.challengeUid)}catch(t){console.error("Error voting for entry:",t),l(n({id:Date.now().toString(),type:"error",message:"Failed to record your vote. Please try again."}))}},j=s=>new Date(s).toLocaleDateString(_,{year:"numeric",month:"long",day:"numeric",timeZone:G});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-8 text-purple-900",children:"Design Challenges"}),W?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-purple-900"})}):e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"mb-16",children:[e.jsx("h2",{className:"text-3xl font-semibold mb-6 text-blue-800",children:"Active Challenges"}),e.jsxs(P,{className:"w-full",children:[e.jsx(E,{children:I.map(s=>e.jsx(k,{className:"md:basis-1/2 lg:basis-1/3",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-lg overflow-hidden transform transition duration-500 hover:scale-105",children:[e.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2 text-purple-900",children:s.title}),e.jsx("p",{className:"text-gray-600 mb-4",children:s.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(w,{variant:"secondary",className:"bg-teal-100 text-teal-800",children:["Deadline: ",j(s.endDate)]}),e.jsxs(D,{onClick:()=>Z(s.challengeUid),className:"bg-blue-600 hover:bg-blue-700 text-white",children:["View Details ",e.jsx(R,{className:"ml-2 h-4 w-4"})]})]})]})]})},s.challengeUid))}),e.jsx(T,{}),e.jsx($,{})]})]}),a&&e.jsxs("section",{className:"mb-16",children:[e.jsx("h2",{className:"text-3xl font-semibold mb-6 text-purple-900",children:a.title}),e.jsxs("div",{className:"bg-white shadow-lg rounded-lg overflow-hidden",children:[e.jsx("img",{src:a.imageUrl,alt:a.title,className:"w-full h-64 object-cover"}),e.jsxs("div",{className:"p-8",children:[e.jsx("p",{className:"text-gray-700 mb-6 text-lg",children:a.description}),e.jsxs(ae,{type:"single",collapsible:!0,className:"w-full mb-8",children:[e.jsxs(N,{value:"rules",children:[e.jsx(y,{className:"text-blue-800",children:"Rules"}),e.jsx(v,{children:a.rules})]}),e.jsxs(N,{value:"guidelines",children:[e.jsx(y,{className:"text-blue-800",children:"Submission Guidelines"}),e.jsx(v,{children:a.submissionGuidelines})]}),e.jsxs(N,{value:"prizes",children:[e.jsx(y,{className:"text-blue-800",children:"Prizes"}),e.jsx(v,{children:a.prizeDetails})]})]}),e.jsxs(w,{variant:"outline",className:"mb-6",children:["Deadline: ",j(a.endDate)]}),o&&!c&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-2xl font-semibold mb-4 text-purple-900",children:"Submit Your Entry"}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),Q()},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"designTitle",className:"block text-sm font-medium text-gray-700",children:"Design Title"}),e.jsx("input",{type:"text",id:"designTitle",name:"designTitle",value:d.designTitle,onChange:C,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"designDescription",className:"block text-sm font-medium text-gray-700",children:"Design Description"}),e.jsx("textarea",{id:"designDescription",name:"designDescription",value:d.designDescription,onChange:C,required:!0,rows:4,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"fileUpload",className:"block text-sm font-medium text-gray-700",children:"Upload Files"}),e.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",children:e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsx(ne,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsxs("div",{className:"flex text-sm text-gray-600",children:[e.jsxs("label",{htmlFor:"fileUpload",className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[e.jsx("span",{children:"Upload files"}),e.jsx("input",{id:"fileUpload",type:"file",onChange:O,multiple:!0,className:"sr-only"})]}),e.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 10MB"})]})})]}),d.fileUrls.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Uploaded Files:"}),e.jsx("ul",{className:"mt-2 border border-gray-200 rounded-md divide-y divide-gray-200",children:d.fileUrls.map((s,t)=>e.jsx("li",{className:"pl-3 pr-4 py-3 flex items-center justify-between text-sm",children:e.jsx("div",{className:"w-0 flex-1 flex items-center",children:e.jsx("span",{className:"ml-2 flex-1 w-0 truncate",children:s.split("/").pop()})})},t))})]}),e.jsx(D,{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white",children:"Submit Entry"})]})]}),c&&e.jsxs("div",{className:"mt-8 bg-gray-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-2xl font-semibold mb-4 text-purple-900",children:"Your Submission"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-lg text-blue-800",children:c.designTitle}),e.jsx("p",{className:"text-gray-700 mt-2",children:c.designDescription}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Submitted Files:"}),e.jsx("ul",{className:"mt-2 grid grid-cols-2 gap-4",children:c.fileUrls.map((s,t)=>e.jsx("li",{className:"relative",children:e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"block",children:[e.jsx("img",{src:s,alt:`Submitted file ${t+1}`,className:"w-full h-32 object-cover rounded-md"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity duration-300",children:e.jsx("span",{className:"text-white text-sm",children:"View Full Size"})})]})},t))})]})]})]}),x&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-2xl font-semibold mb-4 text-purple-900",children:"Voting Results"}),e.jsxs("p",{className:"text-lg mb-4",children:["Total Votes: ",x.totalVotes]}),e.jsx("ul",{className:"space-y-4",children:x.topEntries.map(s=>e.jsxs("li",{className:"bg-white shadow-md rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs(V,{className:"h-10 w-10",children:[e.jsx(z,{src:`https://api.dicebear.com/6.x/initials/svg?seed=${s.designerName}`,alt:s.designerName}),e.jsx(B,{children:s.designerName.charAt(0)})]}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.designTitle}),e.jsxs("p",{className:"text-sm text-gray-500",children:["by ",s.designerName]})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-2xl font-semibold text-blue-600 mr-4",children:s.votes}),o&&e.jsxs(D,{onClick:()=>X(s.submissionUid),className:"bg-blue-100 text-blue-800 hover:bg-blue-200",size:"sm",children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Vote"]})]})]}),e.jsx(le,{value:s.votes/x.totalVotes*100,className:"mt-2"})]},s.submissionUid))})]})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-3xl font-semibold mb-6 text-blue-800",children:"Past Challenges"}),e.jsxs(P,{className:"w-full",children:[e.jsx(E,{children:q.map(s=>e.jsx(k,{className:"md:basis-1/2 lg:basis-1/3",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-lg overflow-hidden",children:[e.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2 text-purple-900",children:s.title}),e.jsxs(w,{variant:"secondary",className:"mb-4",children:["Ended: ",j(s.endDate)]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Winner:"}),e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsxs(V,{className:"h-8 w-8",children:[e.jsx(z,{src:`https://api.dicebear.com/6.x/initials/svg?seed=${s.winnerName}`,alt:s.winnerName}),e.jsx(B,{children:s.winnerName.charAt(0)})]}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:s.winnerName})]}),e.jsxs(te,{to:`/designer/${s.winnerUid}`,className:"mt-4 inline-flex items-center text-blue-600 hover:text-blue-800",children:["View Winner's Profile",e.jsx(R,{className:"ml-1 h-4 w-4"})]})]})]})]})},s.challengeUid))}),e.jsx(T,{}),e.jsx($,{})]})]})]})]})})};export{Ue as default};
