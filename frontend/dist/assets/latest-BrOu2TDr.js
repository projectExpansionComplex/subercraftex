import{d as S,g as Q,u as R,a as U,r as a,h as m,b as i,j as e,L as H}from"./index-DuCqjSN_.js";import{b as J}from"./debounce-BwhyETGv.js";import{B as A}from"./button-WgoBpstD.js";import{I as D}from"./input-pQHlcQ7V.js";import{S as v,a as b,b as w,c as N,d as r}from"./select-Bihb5Gi_.js";import{T as K}from"./toggle-C1PkZ6Jo.js";import{P as W,a as X,b as k,c as Y,d as Z,e as ee}from"./pagination-BYmwyNP_.js";import{G as se,L as te}from"./list-DnFewZ9_.js";import{A as ae}from"./arrow-right-DNlZPxY6.js";import"./isObject-yU4I-yzO.js";import"./utils-bp6eTVW9.js";import"./clsx-B-dksMZM.js";import"./index-Rc2U_xE8.js";import"./index-WcrWcI-o.js";import"./index-DShn9APq.js";import"./index-Ds5EbOBP.js";import"./tslib.es6-Cwz2ACWT.js";import"./index-DRx4Dmjp.js";import"./index-C0VCPdqo.js";import"./chevron-down-D5wGe5Fx.js";import"./chevron-left-SOwOTbK_.js";import"./chevron-right-CX_9zj3K.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]],le=S("BookmarkMinus",re);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"12",x2:"12",y1:"7",y2:"13",key:"1cppfj"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]],oe=S("BookmarkPlus",ie);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],ce=S("Loader",ne);var de=J();const he=Q(de),Le=()=>{const l=R(),{current_user:u,auth_token:c}=U(s=>s.auth),[_,F]=a.useState([]),[d,L]=a.useState({status:null,category_uid:null,budget_min:null,budget_max:null,skills:[]}),[x,E]=a.useState("created_at_desc"),[o,p]=a.useState(1),[j,M]=a.useState(1),[V,P]=a.useState(!1),[z,I]=a.useState([]),[n,T]=a.useState("grid"),[C,$]=a.useState([]),B=a.useCallback(async()=>{P(!0);try{const s=await m.get("http://localhost:1337/api/projects",{params:{...d,sort:x,page:o},headers:c?{Authorization:`Bearer ${c}`}:{}});F(s.data.projects),M(s.data.total_pages)}catch(s){console.error("Error fetching projects:",s),l(i({id:Date.now().toString(),type:"error",message:"Failed to fetch projects. Please try again."}))}finally{P(!1)}},[d,x,o,c,l]),y=he(B,300);a.useEffect(()=>(y(),()=>y.cancel()),[y]),a.useEffect(()=>{(async()=>{try{const t=await m.get("http://localhost:1337/api/project-categories");I(t.data)}catch(t){console.error("Error fetching categories:",t)}})()},[]);const g=(s,t)=>{L(h=>({...h,[s]:t})),p(1)},O=s=>{E(s),p(1)},f=s=>{p(s)},q=async s=>{if(!u){l(i({id:Date.now().toString(),type:"error",message:"Please log in to apply for projects."}));return}try{await m.post(`http://localhost:1337/api/projects/${s}/applications`,{},{headers:{Authorization:`Bearer ${c}`}}),l(i({id:Date.now().toString(),type:"success",message:"Application submitted successfully!"})),B()}catch(t){console.error("Error applying to project:",t),l(i({id:Date.now().toString(),type:"error",message:"Failed to apply for the project. Please try again."}))}},G=async s=>{if(!u){l(i({id:Date.now().toString(),type:"error",message:"Please log in to save projects."}));return}try{C.includes(s)?(await m.delete(`http://localhost:1337/api/users/${u.uid}/saved-projects/${s}`,{headers:{Authorization:`Bearer ${c}`}}),$(t=>t.filter(h=>h!==s)),l(i({id:Date.now().toString(),type:"success",message:"Project removed from saved list."}))):(await m.post(`http://localhost:1337/api/users/${u.uid}/saved-projects/${s}`,{},{headers:{Authorization:`Bearer ${c}`}}),$(t=>[...t,s]),l(i({id:Date.now().toString(),type:"success",message:"Project saved successfully."})))}catch(t){console.error("Error saving/unsaving project:",t),l(i({id:Date.now().toString(),type:"error",message:"Failed to save/unsave the project. Please try again."}))}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-8 text-gray-900",children:"Browse Projects"}),e.jsx("div",{className:"mb-8 bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs(v,{value:d.category_uid||"",onValueChange:s=>g("category_uid",s||null),children:[e.jsx(b,{children:e.jsx(w,{placeholder:"All Categories"})}),e.jsxs(N,{children:[e.jsx(r,{value:"",children:"All Categories"}),z.map(s=>e.jsx(r,{value:s.uid,children:s.name},s.uid))]})]}),e.jsxs(v,{value:d.status||"",onValueChange:s=>g("status",s||null),children:[e.jsx(b,{children:e.jsx(w,{placeholder:"All Statuses"})}),e.jsxs(N,{children:[e.jsx(r,{value:"",children:"All Statuses"}),e.jsx(r,{value:"open",children:"Open"}),e.jsx(r,{value:"in_progress",children:"In Progress"}),e.jsx(r,{value:"completed",children:"Completed"})]})]}),e.jsx(D,{type:"number",placeholder:"Min Budget",value:d.budget_min||"",onChange:s=>g("budget_min",s.target.value?parseInt(s.target.value):null),className:"w-full"}),e.jsx(D,{type:"number",placeholder:"Max Budget",value:d.budget_max||"",onChange:s=>g("budget_max",s.target.value?parseInt(s.target.value):null),className:"w-full"}),e.jsxs(v,{value:x,onValueChange:O,children:[e.jsx(b,{children:e.jsx(w,{placeholder:"Sort By"})}),e.jsxs(N,{children:[e.jsx(r,{value:"created_at_desc",children:"Newest First"}),e.jsx(r,{value:"created_at_asc",children:"Oldest First"}),e.jsx(r,{value:"budget_max_desc",children:"Highest Budget"}),e.jsx(r,{value:"budget_max_asc",children:"Lowest Budget"})]})]})]})}),e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(K,{pressed:n==="grid",onPressedChange:()=>T(n==="grid"?"list":"grid"),"aria-label":"Toggle view mode",children:n==="grid"?e.jsx(se,{className:"h-4 w-4"}):e.jsx(te,{className:"h-4 w-4"})})}),V?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(ce,{className:"h-12 w-12 animate-spin text-blue-500"})}):e.jsxs(e.Fragment,{children:[_.length===0?e.jsx("div",{className:"text-center py-16",children:e.jsx("p",{className:"text-xl text-gray-600",children:"No projects found matching your criteria."})}):e.jsx("div",{className:`grid ${n==="grid"?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":"grid-cols-1 gap-4"}`,children:_.map(s=>e.jsxs("div",{className:`bg-white rounded-lg shadow-md overflow-hidden ${n==="grid"?"flex flex-col":"flex flex-row"}`,children:[e.jsxs("div",{className:`p-6 ${n==="grid"?"flex-grow":"flex-grow w-2/3"}`,children:[e.jsx("h3",{className:"text-xl font-semibold mb-2 text-gray-900",children:s.title}),e.jsx("p",{className:"text-gray-600 mb-4",children:s.description}),e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Budget:"})," ",e.jsxs("span",{className:"text-green-600",children:["$",s.budget_min," - $",s.budget_max]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Deadline:"})," ",e.jsx("span",{className:"text-blue-600",children:new Date(s.deadline).toLocaleDateString()})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Skills:"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:s.skills.map((t,h)=>e.jsx("span",{className:"bg-gray-200 text-gray-700 px-2 py-1 rounded-full text-sm",children:t},h))})]})]}),e.jsxs("div",{className:`p-6 bg-gray-50 ${n==="grid"?"":"w-1/3 flex flex-col justify-center"}`,children:[e.jsx(A,{onClick:()=>q(s.uid),className:"w-full mb-2",children:"Quick Apply"}),e.jsx(A,{onClick:()=>G(s.uid),variant:"outline",className:"w-full mb-2",children:C.includes(s.uid)?e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"mr-2 h-4 w-4"})," Unsave"]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"mr-2 h-4 w-4"})," Save"]})}),e.jsxs(H,{to:`/project/${s.uid}`,className:"block text-center text-blue-500 hover:underline",children:["View Details ",e.jsx(ae,{className:"inline-block ml-1 h-4 w-4"})]})]})]},s.uid))}),j>1&&e.jsx(W,{className:"mt-8",children:e.jsxs(X,{children:[e.jsx(k,{children:e.jsx(Y,{onClick:()=>f(o-1),disabled:o===1})}),Array.from({length:j},(s,t)=>t+1).map(s=>e.jsx(k,{children:e.jsx(Z,{onClick:()=>f(s),isActive:o===s,children:s})},s)),e.jsx(k,{children:e.jsx(ee,{onClick:()=>f(o+1),disabled:o===j})})]})})]})]})})};export{Le as default};
