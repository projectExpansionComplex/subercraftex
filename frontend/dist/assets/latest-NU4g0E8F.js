import{u as ee,B as se,i as te,r as a,a as ae,h as R,b as w,j as e,w as ie}from"./index-D2GD3Ky5.js";import{l as re}from"./lodash-cjLjRAtC.js";import{B as c}from"./button-DkCzGDiL.js";import{I as v}from"./input-C4wLjluH.js";import{S as V,a as q,b as I,c as B,d as m}from"./select-CIix-js0.js";import{P as le,a as ce,b as y,c as ne,d as oe,e as de}from"./pagination-C6Q_5zlN.js";import{S as me}from"./search-DYTRgkLu.js";import{S as xe}from"./shopping-cart-BT0cens7.js";import{G as he,L as ue}from"./list-BHB9QM2U.js";import{S as H}from"./star-DFRRT9bI.js";import{X as pe}from"./x-BcquClZZ.js";import"./utils-RBxwfoyS.js";import"./clsx-B-dksMZM.js";import"./index-C4b4fDol.js";import"./index-B-o7OVwB.js";import"./index-DG9IbPYk.js";import"./index-nF-sxMqU.js";import"./tslib.es6-B8roaPp9.js";import"./index-CKts21x4.js";import"./index-bOXxJ8Ap.js";import"./chevron-down-BUOScESS.js";import"./chevron-left-BEBVYyMJ.js";import"./chevron-right-Cttd4OkI.js";const Ie=()=>{const u=ee(),p=se(),S=te(),[g,U]=a.useState([]),[G,O]=a.useState([]),[Q,C]=a.useState(!0),[t,k]=a.useState({category_uid:null,price_min:null,price_max:null,rating:null}),[l,P]=a.useState("created_at_desc"),[n,x]=a.useState(1),[$,T]=a.useState(1),[o,F]=a.useState("grid"),[r,j]=a.useState(null),[d,z]=a.useState(""),{auth_token:ge}=ae(s=>s.auth);a.useEffect(()=>{X();const s=new URLSearchParams(p.search),i={category_uid:s.get("category")||null,price_min:s.get("price_min")?Number(s.get("price_min")):null,price_max:s.get("price_max")?Number(s.get("price_max")):null,rating:s.get("rating")?Number(s.get("rating")):null};k(i),P(s.get("sort")||"created_at_desc"),x(Number(s.get("page"))||1),z(s.get("search")||"")},[p.search]),a.useEffect(()=>{J()},[t,l,n,d]);const X=async()=>{try{const s=await R.get("http://localhost:1337/api/product-categories");O(s.data)}catch(s){console.error("Error fetching categories:",s),u(w({id:Date.now().toString(),type:"error",message:"Failed to load product categories. Please try again."}))}},J=async()=>{C(!0);try{const s=await R.get("http://localhost:1337/api/products",{params:{...t,sort:l,page:n,limit:20,search:d}});U(s.data.products),T(Math.ceil(s.data.total_count/20))}catch(s){console.error("Error fetching products:",s),u(w({id:Date.now().toString(),type:"error",message:"Failed to load products. Please try again."}))}finally{C(!1)}},f=a.useCallback(re.debounce((s,i,N,A)=>{const h=new URLSearchParams;Object.entries(s).forEach(([Z,D])=>{D!==null&&h.set(Z,D.toString())}),h.set("sort",i),h.set("page",N.toString()),A&&h.set("search",A),S(`${p.pathname}?${h.toString()}`,{replace:!0})},300),[S,p.pathname]),_=(s,i)=>{const N={...t,[s]:i};k(N),x(1),f(N,l,1,d)},K=s=>{P(s),x(1),f(t,s,1,d)},b=s=>{x(s),f(t,l,s,d)},W=s=>{z(s),x(1),f(t,l,1,s)},E=s=>{u(ie({product_uid:s.uid,quantity:1,price:s.price})),u(w({id:Date.now().toString(),type:"success",message:`${s.name} added to cart!`}))},L=a.useMemo(()=>g.filter(s=>!(t.category_uid&&s.category_uid!==t.category_uid||t.price_min&&s.price<t.price_min||t.price_max&&s.price>t.price_max||t.rating&&s.rating<t.rating)),[g,t]),M=a.useMemo(()=>[...L].sort((s,i)=>{switch(l){case"price_asc":return s.price-i.price;case"price_desc":return i.price-s.price;case"rating_desc":return i.rating-s.rating;default:return i.created_at-s.created_at}}),[L,l]),Y=a.useMemo(()=>g.filter(s=>s.is_featured).slice(0,3),[g]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-purple-900",children:"Shop Designs"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(v,{type:"text",placeholder:"Search designs...",value:d,onChange:s=>W(s.target.value),className:"pl-10 pr-4 py-2 w-64"}),e.jsx(me,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20})]}),e.jsx(c,{variant:"outline",size:"icon",children:e.jsx(xe,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx("div",{className:"w-full lg:w-1/4",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-purple-900",children:"Filters"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Category"}),e.jsxs(V,{value:t.category_uid||"",onValueChange:s=>_("category_uid",s||null),children:[e.jsx(q,{className:"w-full",children:e.jsx(I,{placeholder:"All Categories"})}),e.jsxs(B,{children:[e.jsx(m,{value:"",children:"All Categories"}),G.map(s=>e.jsx(m,{value:s.uid,children:s.name},s.uid))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Price Range"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{type:"number",placeholder:"Min",value:t.price_min||"",onChange:s=>_("price_min",s.target.value?Number(s.target.value):null),className:"w-1/2"}),e.jsx(v,{type:"number",placeholder:"Max",value:t.price_max||"",onChange:s=>_("price_max",s.target.value?Number(s.target.value):null),className:"w-1/2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Minimum Rating"}),e.jsx(v,{type:"number",min:"0",max:"5",step:"0.5",value:t.rating||"",onChange:s=>_("rating",s.target.value?Number(s.target.value):null)})]})]})]})}),e.jsxs("div",{className:"w-full lg:w-3/4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mr-2 text-sm font-medium text-gray-700",children:"Sort by:"}),e.jsxs(V,{value:l,onValueChange:K,children:[e.jsx(q,{className:"w-[180px]",children:e.jsx(I,{placeholder:"Sort by"})}),e.jsxs(B,{children:[e.jsx(m,{value:"created_at_desc",children:"Newest"}),e.jsx(m,{value:"price_asc",children:"Price: Low to High"}),e.jsx(m,{value:"price_desc",children:"Price: High to Low"}),e.jsx(m,{value:"rating_desc",children:"Highest Rated"})]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(c,{variant:o==="grid"?"default":"outline",size:"icon",onClick:()=>F("grid"),children:e.jsx(he,{className:"h-4 w-4"})}),e.jsx(c,{variant:o==="list"?"default":"outline",size:"icon",onClick:()=>F("list"),children:e.jsx(ue,{className:"h-4 w-4"})})]})]}),Q?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-900 mx-auto"})}):M.length===0?e.jsx("div",{className:"text-center py-8 text-gray-600",children:"No products found."}):e.jsx("div",{className:`${o==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-6"}`,children:M.map(s=>e.jsxs("div",{className:`bg-white rounded-lg shadow-md overflow-hidden ${o==="list"?"flex":""}`,children:[e.jsx("img",{src:s.image_url||`https://picsum.photos/seed/${s.uid}/300/300`,alt:s.name,className:`w-full h-48 object-cover ${o==="list"?"w-1/3":""}`}),e.jsxs("div",{className:`p-4 ${o==="list"?"w-2/3":""}`,children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-purple-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.designer_name}),e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"text-xl font-bold text-purple-900",children:["$",s.price.toFixed(2)]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"h-4 w-4 text-yellow-400 mr-1"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:s.rating.toFixed(1)})]})]}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>j(s),children:"Quick View"}),e.jsx(c,{size:"sm",onClick:()=>E(s),children:"Add to Cart"})]})]})]},s.uid))}),e.jsx(le,{className:"mt-8",children:e.jsxs(ce,{children:[e.jsx(y,{children:e.jsx(ne,{onClick:()=>b(n-1),disabled:n===1})}),Array.from({length:$},(s,i)=>i+1).map(s=>e.jsx(y,{children:e.jsx(oe,{onClick:()=>b(s),isActive:n===s,children:s})},s)),e.jsx(y,{children:e.jsx(de,{onClick:()=>b(n+1),disabled:n===$})})]})})]})]}),e.jsxs("div",{className:"mt-12",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-purple-900",children:"Featured Products"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:Y.map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("img",{src:s.image_url||`https://picsum.photos/seed/${s.uid}/300/300`,alt:s.name,className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-purple-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.designer_name}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-xl font-bold text-purple-900",children:["$",s.price.toFixed(2)]}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>j(s),children:"View Details"})]})]})]},s.uid))})]})]}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-2xl w-full",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-900",children:r.name}),e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>j(null),children:e.jsx(pe,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsx("img",{src:r.image_url||`https://picsum.photos/seed/${r.uid}/400/400`,alt:r.name,className:"w-full md:w-1/2 h-64 object-cover rounded-lg"}),e.jsxs("div",{className:"flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-2",children:r.designer_name}),e.jsx("p",{className:"mb-4",children:r.description}),e.jsxs("p",{className:"text-2xl font-bold mb-4 text-purple-900",children:["$",r.price.toFixed(2)]}),e.jsxs("div",{className:"flex items-center mb-4",children:[Array.from({length:5}).map((s,i)=>e.jsx(H,{className:`h-5 w-5 ${i<Math.floor(r.rating)?"text-yellow-400":"text-gray-300"}`,fill:"currentColor"},i)),e.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(",r.rating.toFixed(1),")"]})]})]}),e.jsx(c,{onClick:()=>{E(r),j(null)},className:"w-full",children:"Add to Cart"})]})]})]})})]})};export{Ie as default};
