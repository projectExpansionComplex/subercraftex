import{d as h,q as Q,u as U,a as I,r as n,h as d,b as m,j as e,L as R}from"./index-DKe-Z_P2.js";import{S as H}from"./send-CjgVbYqF.js";import{C as T}from"./calendar-CCVXGm4E.js";import{S as M}from"./star-D-PgwYs1.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],V=h("Clock",O);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],S=h("DollarSign",G);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],K=h("Download",J);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],X=h("User",W),se=()=>{const{project_uid:l}=Q(),i=U(),{current_user:p,auth_token:c}=I(t=>t.auth),[a,k]=n.useState(null),[D,A]=n.useState([]),[b,j]=n.useState(!1),[u,g]=n.useState({cover_letter:"",proposed_timeline:null,attachments:[]}),[$,C]=n.useState([]),[f,y]=n.useState(""),[q,N]=n.useState(!0);n.useEffect(()=>{z(),w()},[l]);const z=async()=>{N(!0);try{const t=await d.get(`http://localhost:1337/api/projects/${l}`,{headers:{Authorization:`Bearer ${c}`}});k(t.data),P(t.data.category_uid)}catch(t){console.error("Error fetching project details:",t),i(m({id:Date.now().toString(),type:"error",message:"Failed to load project details."}))}finally{N(!1)}},P=async t=>{try{const s=await d.get("http://localhost:1337/api/projects",{params:{category_uid:t,limit:3},headers:{Authorization:`Bearer ${c}`}});A(s.data.projects)}catch(s){console.error("Error fetching similar projects:",s)}},w=async()=>{try{const t=await d.get(`http://localhost:1337/api/projects/${l}/questions`,{headers:{Authorization:`Bearer ${c}`}});C(t.data)}catch(t){console.error("Error fetching questions:",t)}},v=()=>j(!b),_=t=>{const{name:s,value:r}=t.target;g(x=>({...x,[s]:r}))},F=t=>{t.target.files&&g(s=>({...s,attachments:[...s.attachments,...Array.from(t.target.files)]}))},E=async t=>{var s;t.preventDefault();try{const r=new FormData;r.append("cover_letter",u.cover_letter),r.append("proposed_timeline",((s=u.proposed_timeline)==null?void 0:s.toString())||""),u.attachments.forEach((x,o)=>{r.append(`attachment_${o}`,x)}),await d.post(`http://localhost:1337/api/projects/${l}/applications`,r,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${c}`}}),i(m({id:Date.now().toString(),type:"success",message:"Application submitted successfully."})),j(!1),g({cover_letter:"",proposed_timeline:null,attachments:[]})}catch(r){console.error("Error submitting application:",r),i(m({id:Date.now().toString(),type:"error",message:"Failed to submit application."}))}},L=async t=>{t.preventDefault();try{await d.post(`http://localhost:1337/api/projects/${l}/questions`,{question:f},{headers:{Authorization:`Bearer ${c}`}}),y(""),w(),i(m({id:Date.now().toString(),type:"success",message:"Question submitted successfully."}))}catch(s){console.error("Error submitting question:",s),i(m({id:Date.now().toString(),type:"error",message:"Failed to submit question."}))}},B=async(t,s)=>{try{const r=await d.get(`http://localhost:1337/api/projects/${l}/attachments/${t}`,{responseType:"blob",headers:{Authorization:`Bearer ${c}`}}),x=window.URL.createObjectURL(new Blob([r.data])),o=document.createElement("a");o.href=x,o.setAttribute("download",s),document.body.appendChild(o),o.click(),o.remove()}catch(r){console.error("Error downloading attachment:",r),i(m({id:Date.now().toString(),type:"error",message:"Failed to download attachment."}))}};return q?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-purple-500"})}):a?e.jsx(e.Fragment,{children:e.jsx("div",{className:"container mx-auto px-4 py-8 font-sans",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 p-6 text-white",children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:a.title}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"bg-white text-purple-600 px-3 py-1 rounded-full text-sm font-semibold",children:a.category}),e.jsx("span",{className:"bg-green-500 text-white px-3 py-1 rounded-full text-sm font-semibold",children:a.status})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 p-6",children:[e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[e.jsxs("section",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-gray-800",children:"Project Description"}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:a.description})]}),e.jsxs("section",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-gray-800",children:"Requirements"}),e.jsx("ul",{className:"list-disc list-inside text-gray-600 space-y-2",children:a.required_skills.map((t,s)=>e.jsx("li",{children:t},s))})]}),e.jsxs("section",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-gray-800",children:"Attachments"}),a.attachments.length>0?e.jsx("ul",{className:"space-y-2",children:a.attachments.map(t=>e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx(K,{className:"text-gray-400",size:20}),e.jsx("span",{className:"text-gray-600",children:t.file_name}),e.jsx("button",{onClick:()=>B(t.uid,t.file_name),className:"text-blue-500 hover:text-blue-700 font-medium",children:"Download"})]},t.uid))}):e.jsx("p",{className:"text-gray-500",children:"No attachments available."})]}),p&&p.role==="designer"&&e.jsxs("section",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-gray-800",children:"Apply for This Project"}),b?e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cover_letter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Cover Letter"}),e.jsx("textarea",{id:"cover_letter",name:"cover_letter",rows:4,className:"w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:border-blue-500",value:u.cover_letter,onChange:_,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"proposed_timeline",className:"block text-sm font-medium text-gray-700 mb-1",children:"Proposed Timeline (days)"}),e.jsx("input",{type:"number",id:"proposed_timeline",name:"proposed_timeline",className:"w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:border-blue-500",value:u.proposed_timeline||"",onChange:_,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"attachments",className:"block text-sm font-medium text-gray-700 mb-1",children:"Attachments"}),e.jsx("input",{type:"file",id:"attachments",name:"attachments",multiple:!0,onChange:F,className:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:v,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Submit Application"})]})]}):e.jsx("button",{onClick:v,className:"w-full px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Apply Now"})]}),e.jsxs("section",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-gray-800",children:"Questions & Answers"}),$.map(t=>e.jsxs("div",{className:"mb-4 pb-4 border-b last:border-b-0",children:[e.jsxs("p",{className:"font-medium text-gray-800",children:[t.user_name,": ",t.question]}),t.answer&&e.jsxs("p",{className:"mt-2 text-gray-600 pl-4",children:["Answer: ",t.answer]})]},t.uid)),p&&e.jsxs("form",{onSubmit:L,className:"mt-4",children:[e.jsx("textarea",{value:f,onChange:t=>y(t.target.value),placeholder:"Ask a question...",className:"w-full p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),e.jsxs("button",{type:"submit",className:"mt-2 px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-400",children:[e.jsx(H,{className:"inline-block mr-2",size:16}),"Submit Question"]})]})]})]}),e.jsxs("div",{className:"md:col-span-1 space-y-6",children:[e.jsxs("section",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-gray-800",children:"Project Details"}),e.jsxs("ul",{className:"space-y-3",children:[e.jsxs("li",{className:"flex items-center",children:[e.jsx(S,{className:"text-green-500 mr-2",size:20}),e.jsxs("span",{className:"text-gray-600",children:[e.jsx("strong",{children:"Budget:"})," $",a.budget_min," - $",a.budget_max]})]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(T,{className:"text-blue-500 mr-2",size:20}),e.jsxs("span",{className:"text-gray-600",children:[e.jsx("strong",{children:"Deadline:"})," ",new Date(a.deadline).toLocaleDateString()]})]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(V,{className:"text-purple-500 mr-2",size:20}),e.jsxs("span",{className:"text-gray-600",children:[e.jsx("strong",{children:"Posted:"})," ",new Date(a.created_at).toLocaleDateString()]})]})]})]}),e.jsxs("section",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-gray-800",children:"Client Information"}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(X,{className:"text-gray-400 mr-2",size:20}),e.jsxs("span",{className:"text-gray-600",children:[e.jsx("strong",{children:"Name:"})," ",a.client_name]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"text-yellow-400 mr-2",size:20}),e.jsxs("span",{className:"text-gray-600",children:[e.jsx("strong",{children:"Rating:"})," ",a.client_rating,"/5"]})]})]}),e.jsxs("section",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-gray-800",children:"Similar Projects"}),D.map(t=>e.jsxs("div",{className:"mb-4 last:mb-0",children:[e.jsx(R,{to:`/project/${t.uid}`,className:"text-blue-600 hover:text-blue-800 font-medium block mb-1",children:t.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx(S,{className:"inline-block text-green-500 mr-1",size:14}),"Budget: $",t.budget_min," - $",t.budget_max]})]},t.uid))]})]})]})]})})}):e.jsx("div",{className:"text-center text-red-500 text-xl",children:"Project not found."})};export{se as default};
